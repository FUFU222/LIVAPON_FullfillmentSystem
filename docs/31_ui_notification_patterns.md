# UI 通知・ダイアログ & ランディングガイド

## 目的

このドキュメントは **LIVAPON Fulfillment System** における一時的なフィードバック UI（トースト通知・モーダルダイアログなど）の利用指針と、業務用 SaaS としてのランディングページ設計ガイドラインを整理したものです。目的は以下の通り：

1. フィードバック手段の使い分けを明確化し、開発判断の迷いをなくす
2. ユーザー体験の一貫性と可読性を確保する
3. アクセシビリティ基準（WCAG 2.1 AA）に準拠した実装を担保する
4. 業務ツールらしい落ち着きを保ちながら、一流 SaaS のような洗練感を持たせるための UI 戦略を共有する

---

## 1. パターン選択の原則

| ユースケース                   | 推奨パターン                       | 理由・補足                                                       |
| ------------------------------ | ---------------------------------- | ---------------------------------------------------------------- |
| 成功・警告など軽量な非同期結果 | **トースト（Toast）**              | 操作を妨げず、完了を即座に伝えられる。再試行不要なケースに限定。 |
| 即時の判断・確認が必要な操作   | **モーダルダイアログ（Dialog）**   | 背景操作をロックし、フォーカスを明確に誘導できる。               |
| 継続的に見せたい状態・注意喚起 | **バナー／インラインメッセージ**   | トーストでは読み逃しが発生するため、永続的に提示する。           |
| 多数のイベント・ログ確認       | **アクティビティフィード／バッジ** | トースト乱用を避け、ユーザーの情報過多を防ぐ。                   |

---

## 2. トースト通知（Toast）

### 🟢 用いる場面

- 保存・同期完了、軽度エラー、フォーム送信完了など。
- 表示時間は 2〜5 秒。内容が長い場合は「詳細を見る」リンクを設ける。

### 🔴 避ける場面

- 重要なエラーや確認が必要な処理。
- 確定操作・削除など、ユーザーの明示的同意を要する場合。

### ⚙️ 実装ルール

- 表示位置は **右上固定**。同時表示は最大 2 件まで。
- メッセージ構成は「タイトル + 1 行本文 + アイコン（任意）」。
- 成功：緑系／警告：黄系／エラー：赤系。ただし色だけに依存せずアイコン併用。
- `aria-live="polite"` を使用し、音声読み上げを有効化。
- ホバー中は自動消去を一時停止。
- 表示中に同一メッセージを連続出さないよう ID で制御（例：`toastId="order-sync"`）。


3. モーダルダイアログ（Dialog）
🟢 用いる場面
破壊的操作（削除・確定）の確認

詳細編集やログイン、再認証など現在タスクに直結する意思決定

🔴 避ける場面
単なる情報提示や大量入力（→ スライドオーバーまたは専用ページに分離）

⚙️ アクセシビリティ実装要件
要件	内容
ARIA属性	role="dialog"（または alertdialog）＋ aria-modal="true"
フォーカス制御	オープン時に主要操作ボタンまたはタイトルへ移動。Tab移動はモーダル内で循環。
終了操作	Esc キー＋明示的な閉じるボタンを必須化。閉じたら元のトリガー要素へフォーカスを戻す。
背景制御	inert または aria-hidden を付与し、背景操作をブロック。
フォーカストラップ	@radix-ui/react-dialog や shadcn/ui の Dialog コンポーネントで自動管理可。

💻 コード例（shadcn/ui）
tsx
コードをコピーする
import { Dialog, DialogContent, DialogHeader, DialogTitle } from "@/components/ui/dialog";

<Dialog open={open} onOpenChange={setOpen}>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>出荷を確定しますか？</DialogTitle>
    </DialogHeader>
    <p>この操作は取り消せません。</p>
    <Button onClick={handleConfirm}>確定</Button>
  </DialogContent>
</Dialog>
4. その他の通知手段
種類	用途	実装例
バナー	全システムに影響するメンテナンス・お知らせ	components/ui/banner.tsx
インラインメッセージ	フォームバリデーション、局所的なエラー	Alert コンポーネント
アクティビティフィード	履歴・非同期ジョブの追跡	サイドパネル／別ページ表示

5. LIVAPON実装での適用ポイント
✅ トースト
ToastProvider はルートレイアウト直下に配置済み。

コンポーネント内で useToast() を呼び出し、IDで重複を防止。

長時間処理（例：CSVインポート中）は duration: Infinity で表示し、完了時に手動Dismiss。

表示イベントはSupabaseアクション成功後に限定。

✅ モーダル
confirm-dialog.tsx に統一。

QAでは以下3点を確認：
① Tab移動範囲がモーダル内に限定されるか
② Escキーで閉じられるか
③ 閉じた後、元ボタンにフォーカス復帰しているか

6. 設計レビュー時のチェックリスト
 通知の「重要度」「持続時間」「必要アクション」が定義されている

 トーストとモーダルの選択が表に沿って妥当

 aria-* 属性とフォーカス制御の実装を確認

 アニメーション速度が200–300ms以内に収まっている

 VoiceOver／NVDAで読み上げを確認済み

 トースト重複・同時多発を防ぐIDロジック実装済み

7. 今後の拡張
トースト履歴を「アクティビティログ」に統合し、見逃した通知を再確認可能に。

GlobalBanner コンポーネントでメンテナンス／障害情報を共通化。

自動リロード画面ではトーストより「最終更新時刻 + 手動更新ボタン」パターンを標準化。

参考資料
Carbon Design System: Notification Pattern

Google Material 3: Dialogs & Snackbars

UX Movement: Usable Toasts

Medium: Accessibility Before You Get Toast-Happy

Sheri Byrne-Haber: Designing Toasts for Accessibility

---

## 8. ランディングページ設計ガイド

### 8.1 目指すトーン

- **業務ツールらしい信頼感**：過度な演出や派手なグラデーションは避ける。
- **一流 SaaS の洗練**：余白・タイポグラフィ・アクセントカラーの使い方を整え、初見のベンダーにも安心してもらう。
- **ブランドカラー**：アクセントは `#801010` を基調とし、サブアクセントはグレー 600〜900 を中心に使用。

### 8.2 ヒーローセクション

- **コンテンツ構成**
  - キャッチコピー（2行以内）
  - 価値の一文（「手動更新がシンプル」「承認後すぐに利用可能」など）
  - CTA ボタン：主CTA（サインイン／管理画面に移動）、副CTA（ベンダー申請）
  - ベンダーフロー：利用申請 → 承認 → 利用開始の 3 ステップをカードで表示
- **余白**
  - ヒーローは `min-h-screen` を維持しつつ、タイトル上の余白を `gap-4~6` に抑える。
  - CTA は 16px 高さ前後で統一し、横幅を揃える。
- **背景演出**
  - 極力フラットなグラデーションに留め、意味のある装飾（例：薄いライン、モノクロの幾何学パターン）に限定。
  - 背景グラフィックを使う場合は `opacity 10-15%` 程度で視認性を損なわないこと。

### 8.3 タイポグラフィ

- 見出し（H1）：`text-4xl sm:text-5xl`、 `font-semibold`
- 小見出し・カードタイトル：`text-lg font-semibold`
- 本文：`text-sm sm:text-base text-slate-600`
- 補足・ノート：`text-xs text-slate-400`

### 8.4 コンポーネント指針

- **CTA ボタン**
  - 主要CTA: `bg-black text-white` + `hover:bg-black/90`、微小な移動（`hover:-translate-y-0.5`）で反応を付ける。
  - 副CTA: `border border-black/20 text-slate-900`、hoverで柔らかくグレー背景。
  - クリック時は `active:translate-y-0` にして浮遊感を抑えめに。
- **フローカード**
  - 各カードに `border-black/10` と `shadow-black/10` の淡い影を付け、余白を `p-4` に統一。
  - カード間のラインは太め (`h-1`) でグラデーションを効かせ、フローであることを強調。
- **説明テキスト**
  - 各カード説明は 2～3 行以内。冗長な文章は避ける。
  - CTA 付近に「このフローでできること」「運用上の安心材料」を補足する短文を置く。

### 8.5 レスポンシブ

- モバイルでは縦方向に整列し、CTA → フローの順で表示する。
- フローの連結ラインは縦向き（`.w-1 h-10`）に切り替え、上下方向の連続性を確保。

### 8.6 コピーの基本

- ベンダーの即時メリットを 1 文目に書く（例：`「発送登録と追跡番号送信をシンプルに」`）。
- 余計な横文字は避け、業務ユーザーが理解しやすい語彙を選ぶ。

### 8.7 レビュー項目

- [ ] 余白・タイポグラフィが統一されているか
- [ ] CTA のヒエラルキーが明確か（主要CTAがひと目で分かる）
- [ ] フローが視覚的に繋がっており、説明が 3 センテンス以内に収まっているか
- [ ] ブランドカラー `#801010` の使い方が過剰になっていないか（アクセントに限定）
- [ ] モバイルビューでもスクロール 1 回以内に CTA とフローが見えるか
```
